---

- name: install plex
  pkgng: name=plexmediaserver state=present

- name: flush handlers to start plex (plexdata dir needed in other tasks)
  meta: flush_handlers

- name: install trakt scrobble plugin
  include: trakt_scrobbler.yaml

- name: install hello hue plugin
  include: hello_hue.yaml

- name: install youtube tv plugin
  include: youtube.yaml

- name: monitor plex logs
  copy: src=plex.filebeat.yaml dest=/usr/local/etc/filebeat.d/plex.yml
        owner=root group=wheel mode=0644
  notify: restart filebeat
  tags: [logs]

- name: enable plex
  service: name=plexmediaserver enabled=yes
  notify: start plex
